# WAC

## Модель

![Документ](@document/asoc.platform.vulnerability_management.wac.models)

### Product

Дубликат `product` в `DefectDojo`.

Для сопоставления `product` в платформе к `product` в `DefectDojo` возможно использовать поле `name`.
Т.к оно в `DefectDojo` обязательно и уникально.
При этом в самой платформе в качестве референса на `product` использовать поле `uuid`.

В качестве значений обязательных полей для `DefectDojo` возможно использовать значения по умолчанию.
Данные поля не попадают в модель платформы.

### ProductDefectDojo

Маппер `ASOC Product` к `DefectDojo Product`

Т.к в качестве идентификатора `Product` в `ASOC` используется `uuid`, в отличии от `id int` в `DefectDojo`
сопоставление проихсодит через дополнительную сущность `ProductDefectDojo`

* `defect_dojo_id`: `id` Product в DefectDojo
* `product_uuid`: `uuid` Product в ASOC

### ActionTemplate

Шаблон `action'а` создается пользователем в рамках `workspace`.

При применении к `SecurityPipeline` создается копия со связми.

* `step`: порядковый номер `action`'а - для возможности запуска параллельно/последовательно

### ScanSettings

Должна храниться в отдельном сервисе (на MVP возможно в DefectDojo). 

### SecurityPipelineExecution

* `name`: Имя запущенного pipeline, имя генерируется в зависимости от параметров запуска.

Является ключем сопоставления `ASOC SecurityPipelineExecution` к `DefectDojo Engemenet`

### VCSEvent

Событие полученное от VCS.

* `type`: Тип события 
* `action`: TODO
* `host_name`: Hostname VCS хостинга (gitlab.com)
* `project_id`: Уникальный идентификатор remote VCS репозитория на VCS хостинге
* `project_path`: Путь к удаленному репозиторию (группа/имя репозитория) (group/repo_name)
* `hash_commit`: Хэш коммита, которое сгенерировало событие
* `ref`: Референс сущности VCS (тег, имя ветки), которое сгенерировало событие
* `date`: Время генерации события

## Схема БД

![Документ](@document/asoc.platform.vulnerability_management.wac.schema_db)

## Workflows

### Запуск pipeline 

![Документ](@document/asoc.platform.vulnerability_management.wac.workflows.run_pipeline)

### Запуск pipeline мануально

![Документ](@document/asoc.platform.vulnerability_management.wac.workflows.run_pipeline_manually)

### Статусная модель pipeline

![Документ](@document/asoc.platform.vulnerability_management.wac.workflows.pipeline_states)
