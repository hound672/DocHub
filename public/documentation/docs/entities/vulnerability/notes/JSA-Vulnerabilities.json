[
{
  "Version": "3.0",
  "Id": "4201893492",
  "GroupId": "c:\\work\\pt-jsa\\modules\\jsa.javascript\\tests\\assets\\func\\jsa.javascript.vulnerstests\\external\\dvna\\core\\apphandler.js:11:3:14:7",
  "ScanMode": "FromEntryPoint",
  "Class": "Vulnerability",
  "Type": "SQL Injection",
  "IsSuspected": false,
  "IsSecondOrder": false,
  "IsSuppressed": false,
  "VulnerableExpression": {
    "Value": "db.sequelize.query(query, {\r\n    model: db.User,\r\n})",
    "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
    "BeginLine": 11,
    "BeginColumn": 3,
    "EndLine": 14,
    "EndColumn": 7
  },
  "EntryPoint": {
    "Value": "app.listen(config.port, config.listen)",
    "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\server.js",
    "BeginLine": 42,
    "BeginColumn": 1,
    "EndLine": 42,
    "EndColumn": 39
  },
  "AdditionalConditions": "((!! request.isAuthenticated()) === true)",
  "Exploit": {
    "Type": "HTTP",
    "Text": "POST /app/usersearch? HTTP/1.1\r\nHost: localhost\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 0\r\n\r\nlogin=sleep(5)\r\n\r\n",
    "Parameters": []
  },
  "TaintDataEntries": [
    {
      "Value": "req.body",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 10,
      "BeginColumn": 59,
      "EndLine": 10,
      "EndColumn": 67
    }
  ],
  "DataTrace": [
    {
      "Value": "db.sequelize.query(query, {\r\n    model: db.User,\r\n})",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 11,
      "BeginColumn": 3,
      "EndLine": 14,
      "EndColumn": 7
    }
  ],
  "BestPlaceToFix": null
},
// 2023-12-18 12:32:40.395
{
  "Version": "3.0",
  "Id": "4076434742",
  "GroupId": "c:\\work\\pt-jsa\\modules\\jsa.javascript\\tests\\assets\\func\\jsa.javascript.vulnerstests\\external\\dvna\\core\\apphandler.js:250:20:253:6",
  "ScanMode": "FromEntryPoint",
  "Class": "Vulnerability",
  "Type": "XML External Entity",
  "IsSuspected": false,
  "IsSecondOrder": false,
  "IsSuppressed": false,
  "VulnerableExpression": {
    "Value": "libxmljs.parseXmlString(\r\nreq.files.products.data.toString(\"utf8\"), {\r\n    noent: true,\r\n    noblanks: true\r\n})",
    "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
    "BeginLine": 250,
    "BeginColumn": 20,
    "EndLine": 253,
    "EndColumn": 6
  },
  "EntryPoint": {
    "Value": "app.listen(config.port, config.listen)",
    "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\server.js",
    "BeginLine": 42,
    "BeginColumn": 1,
    "EndLine": 42,
    "EndColumn": 39
  },
  "AdditionalConditions": "((!! request.files.products) && ((!! request.isAuthenticated()) === true))",
  "Exploit": {
    "Type": "HTTP",
    "Text": "POST /app/bulkproducts?mimetype=text%2Fxml HTTP/1.1\r\nHost: localhost\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 0\r\n\r\n\r\n\r\n",
    "Parameters": []
  },
  "TaintDataEntries": [
    {
      "Value": "next()",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\authHandler.js",
      "BeginLine": 8,
      "BeginColumn": 10,
      "EndLine": 8,
      "EndColumn": 16
    }
  ],
  "DataTrace": [
    {
      "Value": "req.files",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 251,
      "BeginColumn": 7,
      "EndLine": 251,
      "EndColumn": 16
    },
    {
      "Value": "req.files.products",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 251,
      "BeginColumn": 7,
      "EndLine": 251,
      "EndColumn": 25
    },
    {
      "Value": "req.files.products.data",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 251,
      "BeginColumn": 7,
      "EndLine": 251,
      "EndColumn": 30
    },
    {
      "Value": "req.files.products.data.toString(\"utf8\")",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 251,
      "BeginColumn": 7,
      "EndLine": 251,
      "EndColumn": 47
    },
    {
      "Value": "libxmljs.parseXmlString(\r\nreq.files.products.data.toString(\"utf8\"), {\r\n    noent: true,\r\n    noblanks: true\r\n})",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 250,
      "BeginColumn": 20,
      "EndLine": 253,
      "EndColumn": 6
    }
  ],
  "BestPlaceToFix": null
},
// 2023-12-18 12:32:40.638
{
  "Version": "3.0",
  "Id": "1519420973",
  "GroupId": "c:\\work\\pt-jsa\\modules\\jsa.javascript\\tests\\assets\\func\\jsa.javascript.vulnerstests\\external\\dvna\\core\\apphandler.js:228:20:230:6",
  "ScanMode": "FromEntryPoint",
  "Class": "Vulnerability",
  "Type": "Deserialization of Untrusted Data",
  "IsSuspected": false,
  "IsSecondOrder": false,
  "IsSuppressed": false,
  "VulnerableExpression": {
    "Value": "serialize.unserialize(\r\nreq.files.products.data.toString(\"utf8\"))",
    "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
    "BeginLine": 228,
    "BeginColumn": 20,
    "EndLine": 230,
    "EndColumn": 6
  },
  "EntryPoint": {
    "Value": "app.listen(config.port, config.listen)",
    "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\server.js",
    "BeginLine": 42,
    "BeginColumn": 1,
    "EndLine": 42,
    "EndColumn": 39
  },
  "AdditionalConditions": "((!! request.files.products) && ((!! request.isAuthenticated()) === true) && ((String(request.files.products.data.toString(\"utf8\"))) === \"{'rce':'_$$ND_FUNC$$_console.log(1337)'}\"))",
  "Exploit": {
    "Type": "HTTP",
    "Text": "POST /app/bulkproductslegacy HTTP/1.1\r\nHost: localhost\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 0\r\n\r\n\r\n\r\n",
    "Parameters": []
  },
  "TaintDataEntries": [
    {
      "Value": "next()",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\authHandler.js",
      "BeginLine": 8,
      "BeginColumn": 10,
      "EndLine": 8,
      "EndColumn": 16
    }
  ],
  "DataTrace": [
    {
      "Value": "req.files",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 229,
      "BeginColumn": 7,
      "EndLine": 229,
      "EndColumn": 16
    },
    {
      "Value": "req.files.products",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 229,
      "BeginColumn": 7,
      "EndLine": 229,
      "EndColumn": 25
    },
    {
      "Value": "req.files.products.data",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 229,
      "BeginColumn": 7,
      "EndLine": 229,
      "EndColumn": 30
    },
    {
      "Value": "req.files.products.data.toString(\"utf8\")",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 229,
      "BeginColumn": 7,
      "EndLine": 229,
      "EndColumn": 47
    },
    {
      "Value": "serialize.unserialize(\r\nreq.files.products.data.toString(\"utf8\"))",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 228,
      "BeginColumn": 20,
      "EndLine": 230,
      "EndColumn": 6
    }
  ],
  "BestPlaceToFix": null
},
// 2023-12-18 12:32:40.916
{
  "Version": "3.0",
  "Id": "3260434824",
  "GroupId": "c:\\work\\pt-jsa\\modules\\jsa.javascript\\tests\\assets\\func\\jsa.javascript.vulnerstests\\external\\dvna\\core\\apphandler.js:42:3:47:5",
  "ScanMode": "FromEntryPoint",
  "Class": "Vulnerability",
  "Type": "OS Commanding",
  "IsSuspected": false,
  "IsSecondOrder": false,
  "IsSuppressed": false,
  "VulnerableExpression": {
    "Value": "exec(\"ping -c 2 \" + req.body.address, function (err, stdout, stderr) {\r\n    output = stdout + stderr;\r\n    res.render(\"app/ping\", {\r\n        output: output,\r\n    });\r\n})",
    "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
    "BeginLine": 42,
    "BeginColumn": 3,
    "EndLine": 47,
    "EndColumn": 5
  },
  "EntryPoint": {
    "Value": "app.listen(config.port, config.listen)",
    "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\server.js",
    "BeginLine": 42,
    "BeginColumn": 1,
    "EndLine": 42,
    "EndColumn": 39
  },
  "AdditionalConditions": "((!! request.isAuthenticated()) === true)",
  "Exploit": {
    "Type": "HTTP",
    "Text": "POST /app/ping? HTTP/1.1\r\nHost: localhost\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 0\r\n\r\naddress=whoami\r\n\r\n",
    "Parameters": []
  },
  "TaintDataEntries": [
    {
      "Value": "req.body",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 42,
      "BeginColumn": 23,
      "EndLine": 42,
      "EndColumn": 31
    }
  ],
  "DataTrace": [
    {
      "Value": "req.body",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 42,
      "BeginColumn": 23,
      "EndLine": 42,
      "EndColumn": 31
    },
    {
      "Value": "req.body.address",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 42,
      "BeginColumn": 23,
      "EndLine": 42,
      "EndColumn": 39
    },
    {
      "Value": "exec(\"ping -c 2 \" + req.body.address, function (err, stdout, stderr) {\r\n    output = stdout + stderr;\r\n    res.render(\"app/ping\", {\r\n        output: output,\r\n    });\r\n})",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 42,
      "BeginColumn": 3,
      "EndLine": 47,
      "EndColumn": 5
    }
  ],
  "BestPlaceToFix": null
},
// 2023-12-18 12:32:41.228
{
  "Version": "3.0",
  "Id": "3999140779",
  "GroupId": "c:\\work\\pt-jsa\\modules\\jsa.javascript\\tests\\assets\\func\\jsa.javascript.vulnerstests\\external\\dvna\\core\\apphandler.js:207:15:207:40",
  "ScanMode": "FromEntryPoint",
  "Class": "Vulnerability",
  "Type": "Remote Code Execution",
  "IsSuspected": false,
  "IsSecondOrder": false,
  "IsSuppressed": false,
  "VulnerableExpression": {
    "Value": "mathjs.eval(req.body.eqn)",
    "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
    "BeginLine": 207,
    "BeginColumn": 15,
    "EndLine": 207,
    "EndColumn": 40
  },
  "EntryPoint": {
    "Value": "app.listen(config.port, config.listen)",
    "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\server.js",
    "BeginLine": 42,
    "BeginColumn": 1,
    "EndLine": 42,
    "EndColumn": 39
  },
  "AdditionalConditions": "((!! request.isAuthenticated()) === true)",
  "Exploit": {
    "Type": "HTTP",
    "Text": "POST /app/calc? HTTP/1.1\r\nHost: localhost\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 0\r\n\r\neqn=console.log(1337)\r\n\r\n",
    "Parameters": []
  },
  "TaintDataEntries": [
    {
      "Value": "req.body",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 207,
      "BeginColumn": 27,
      "EndLine": 207,
      "EndColumn": 35
    }
  ],
  "DataTrace": [
    {
      "Value": "req.body",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 207,
      "BeginColumn": 27,
      "EndLine": 207,
      "EndColumn": 35
    },
    {
      "Value": "req.body.eqn",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 207,
      "BeginColumn": 27,
      "EndLine": 207,
      "EndColumn": 39
    },
    {
      "Value": "mathjs.eval(req.body.eqn)",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 207,
      "BeginColumn": 15,
      "EndLine": 207,
      "EndColumn": 40
    }
  ],
  "BestPlaceToFix": null
},
// 2023-12-18 12:32:41.427
{
  "Version": "3.0",
  "Id": "3723287205",
  "GroupId": "c:\\work\\pt-jsa\\modules\\jsa.javascript\\tests\\assets\\func\\jsa.javascript.vulnerstests\\external\\dvna\\core\\apphandler.js:198:5:198:32",
  "ScanMode": "FromEntryPoint",
  "Class": "Vulnerability",
  "Type": "Open Redirect",
  "IsSuspected": false,
  "IsSecondOrder": false,
  "IsSuppressed": false,
  "VulnerableExpression": {
    "Value": "res.redirect(req.query.url)",
    "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
    "BeginLine": 198,
    "BeginColumn": 5,
    "EndLine": 198,
    "EndColumn": 32
  },
  "EntryPoint": {
    "Value": "app.listen(config.port, config.listen)",
    "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\server.js",
    "BeginLine": 42,
    "BeginColumn": 1,
    "EndLine": 42,
    "EndColumn": 39
  },
  "AdditionalConditions": "",
  "Exploit": {
    "Type": "HTTP",
    "Text": "GET /app/redirect?url=http%3A%2F%2Flocalhost HTTP/1.1\r\nHost: localhost\r\n",
    "Parameters": []
  },
  "TaintDataEntries": [
    {
      "Value": "req.query",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 198,
      "BeginColumn": 18,
      "EndLine": 198,
      "EndColumn": 27
    }
  ],
  "DataTrace": [
    {
      "Value": "req.query",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 198,
      "BeginColumn": 18,
      "EndLine": 198,
      "EndColumn": 27
    },
    {
      "Value": "req.query.url",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 198,
      "BeginColumn": 18,
      "EndLine": 198,
      "EndColumn": 31
    },
    {
      "Value": "res.redirect(req.query.url)",
      "File": "c:\\Work\\pt-jsa\\Modules\\JSA.JavaScript\\Tests\\Assets\\Func\\JSA.JavaScript.VulnersTests\\external\\dvna\\core\\appHandler.js",
      "BeginLine": 198,
      "BeginColumn": 5,
      "EndLine": 198,
      "EndColumn": 32
    }
  ],
  "BestPlaceToFix": null
}]
